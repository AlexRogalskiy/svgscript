<!doctype html>
<html>
<head>
	<meta charset="UTF-8">
	<title>SvgScript</title>
	<meta name=viewport
	      content="initial-scale=0.5, minimum-scale=0.5">
	<link rel="stylesheet" href="screen.css"/>
</head>
<body>

<div id="wrapper">

	<header>
		<nav>
			<h1 id="logo">Icons</h1>
			<button id="toggleGrid">Grid</button>
		</nav>
	</header>


	<div id="icons">
	</div>

</div>

<!--<script src="/socket.io/socket.io.js"></script>-->
<script>
	var shaven = require('shaven'),
		index = require('./index'),
	//socket = io('http://localhost'),
		gridVisibility = false


	document
		.getElementById('icons')
		.innerHTML = index
		.getIcons()
		.map(function (icon) {
			return '<div class=icon id=' + icon.fileName + '>' +
			       icon.content +
			       '</div>'
		})
		.join('')


	function toggleGrid () {

		var svgs = document.querySelectorAll('svg'),
			gridContainers,
			i

		if (gridVisibility) {

			gridContainers = document.querySelectorAll('svg .grid')

			for (i = 0; i < gridContainers.length; i++)
				gridContainers[i].remove()

			gridVisibility = false
		}
		else {
			for (i = 0; i < svgs.length; i++) {
				!function () {

					var gridFragment = ['g.grid', {
							style: {
								fill: 'rgb(255, 255, 200)',
								stroke: 'red',
								'stroke-width': 0.1
							}
						},
							['line', {
								style: {
									'stroke-width': 1
								},
								x1: 0,
								y1: -100,
								x2: 0,
								y2: 100
							}
							],
							['line', {
								style: {
									'stroke-width': 1
								},
								x1: -100,
								y1: 0,
								x2: 100,
								y2: 0
							}
							]
						],
						lines = [],
						a

					// Horizontal lines
					for (a = 0; a < 200; a++)
						lines.push(
							['line', {
								x1: -100 + a,
								y1: -100,
								x2: -100 + a,
								y2: 100
							}]
						)


					// Vertical lines
					for (a = 0; a < 200; a++)
						lines.push(
							['line', {
								x1: -100,
								y1: -100 + a,
								x2: 100,
								y2: -100 + a
							}]
						)


					shaven([svgs[i], gridFragment.concat(lines)], 'http://www.w3.org/2000/svg')
				}()
			}

			gridVisibility = true
		}
	}

	document
		.querySelector('#toggleGrid')
		.addEventListener('click', function (event) {
			toggleGrid()
		})


	/*
	 socket.on('icon', function (data) {
	 var iconContainer = document.querySelector('#' + data.fileName)

	 iconContainer.innerHTML = data.content
	 })
	 */

</script>
</body>
</html>
